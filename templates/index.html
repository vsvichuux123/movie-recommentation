<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>AI Movie Recommendation System</title>
    <style>
        /* Reset & basic */
        * {
          box-sizing: border-box;
          margin: 0; padding: 0;
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          color: #eee;
        }
        body, html {
          height: 100%;
          overflow: hidden;
          background: #0e0e0e;
        }

        /* Container centered */
        .container {
          position: relative;
          z-index: 10;
          max-width: 600px;
          margin: 60px auto;
          background: rgba(0,0,0,0.7);
          border-radius: 15px;
          padding: 30px 40px;
          box-shadow: 0 0 30px rgba(0,255,255,0.4);
          text-align: center;
        }

        h1 {
          margin-bottom: 20px;
          font-weight: 700;
          text-shadow: 0 0 5px #00faff;
        }

        input[type="text"] {
          width: 80%;
          padding: 12px 15px;
          border-radius: 10px;
          border: none;
          font-size: 18px;
          outline: none;
          margin-right: 10px;
          box-shadow: inset 0 0 8px #00faff;
          background: #121212;
          color: #00faff;
          transition: 0.3s;
        }
        input[type="text"]:focus {
          box-shadow: 0 0 12px #00faff;
          background: #001f2f;
        }

        button {
          padding: 12px 25px;
          font-size: 18px;
          border-radius: 10px;
          border: none;
          background: #00faff;
          color: #000;
          font-weight: bold;
          cursor: pointer;
          box-shadow: 0 0 20px #00faff;
          transition: 0.3s;
        }
        button:hover {
          background: #00d1ff;
          box-shadow: 0 0 30px #00d1ff;
        }

        h2 {
          margin: 30px 0 15px;
          text-shadow: 0 0 5px #00faff;
        }

        ul {
          list-style: none;
          text-align: left;
          padding-left: 0;
          max-height: 300px;
          overflow-y: auto;
          color: #0ff;
        }

        ul li {
          padding: 8px 12px;
          border-bottom: 1px solid #00faff33;
          font-size: 18px;
          cursor: default;
          user-select: none;
          transition: background-color 0.3s;
        }
        ul li:hover {
          background: #00faff22;
        }

        /* Fullscreen canvas for three.js */
        #bgCanvas {
          position: fixed;
          top: 0; left: 0;
          width: 100vw;
          height: 100vh;
          z-index: 1;
          display: block;
          background: #0e0e0e;
        }
    </style>
</head>
<body>
<canvas id="bgCanvas"></canvas>

<div class="container">
    <h1>AI Movie Recommendation System</h1>

    <input type="text" id="movieInput" placeholder="Enter your favorite movie" autocomplete="off" />
    <button onclick="getRecommendations()">Get Recommendations</button>

    <h2>Recommended Movies:</h2>
    <ul id="recommendationsList"></ul>
</div>

<!-- Include three.js library -->
<script src="https://cdn.jsdelivr.net/npm/three@0.154.0/build/three.min.js"></script>

<script>
    // 3D background animation using three.js
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('bgCanvas'), alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    camera.position.z = 30;

    // Create particles
    const particlesCount = 400;
    const geometry = new THREE.BufferGeometry();
    const positions = new Float32Array(particlesCount * 3);

    for (let i = 0; i < particlesCount * 3; i++) {
      positions[i] = (Math.random() - 0.5) * 100;
    }
    geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

    const material = new THREE.PointsMaterial({
      color: 0x00faff,
      size: 0.6,
      transparent: true,
      opacity: 0.7
    });

    const particles = new THREE.Points(geometry, material);
    scene.add(particles);

    function animate() {
      requestAnimationFrame(animate);

      geometry.attributes.position.array.forEach((_, i, arr) => {
        if(i % 3 === 1) { // animate Y axis
          arr[i] -= 0.1;
          if(arr[i] < -50) arr[i] = 50;
        }
      });
      geometry.attributes.position.needsUpdate = true;

      particles.rotation.y += 0.002;
      particles.rotation.x += 0.001;

      renderer.render(scene, camera);
    }
    animate();

    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Recommendation fetch logic
    async function getRecommendations() {
      const movie = document.getElementById('movieInput').value;
      if (!movie) {
        alert('Please enter a movie name');
        return;
      }

      const response = await fetch('/recommend', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ movie })
      });

      if (!response.ok) {
        alert('Server error: ' + response.status);
        return;
      }

      const data = await response.json();
      const list = document.getElementById('recommendationsList');
      list.innerHTML = '';

      if (data.recommendations.length === 0) {
        list.innerHTML = '<li>No recommendations found.</li>';
      } else {
        data.recommendations.forEach(m => {
          const li = document.createElement('li');
          li.textContent = m;
          list.appendChild(li);
        });
      }
    }
</script>
</body>
</html>
